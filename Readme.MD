Простой сервис без разделения по слоям и внешней БД
Показывает как устроена реализация с применение jwt и csrf токена для работы с защищенными роутами

CSRF-токен (Cross-Site Request Forgery token) — это механизм безопасности, предназначенный для защиты веб-приложений от атак, известных как CSRF. Эти атаки позволяют злоумышленникам обманом заставить пользователя выполнить нежелательные действия на сайте, где он аутентифицирован, без его ведома.
Как работает CSRF-токен?
Генерация токена: Когда пользователь заходит на сайт, сервер генерирует уникальный и случайный CSRF-токен. Этот токен сохраняется на сервере и отправляется клиенту, обычно в виде скрытого поля в форме или в HTTP-заголовке.
Отправка запроса: При отправке формы или выполнении действия, которое изменяет состояние на сервере (например, POST-запрос), клиент должен включить этот токен в запрос.
Проверка токена: Когда сервер получает запрос, он проверяет токен, отправленный с запросом, с тем, который хранится в сессии пользователя. Если токены совпадают, запрос считается действительным и обрабатывается. Если нет — запрос отклоняется.
Зачем нужен CSRF-токен?
CSRF-токены защищают от следующих угроз:
Подделка запросов: Злоумышленник может попытаться отправить запрос от имени пользователя без его ведома.
Кража данных: Направляя поддельные запросы, злоумышленник может получить доступ к конфиденциальной информации.
Несанкционированные действия: Атакующий может инициировать действия от имени пользователя (например, перевод денег или изменение настроек аккаунта).
Принципы генерации и использования CSRF-токенов
Уникальность и случайность: Токены должны быть уникальными для каждой сессии и генерироваться с использованием криптографически безопасного генератора случайных чисел.
Срок действия: Токены должны иметь конечное время жизни для повышения безопасности.
Использование только один раз: Лучше всего использовать токены так, чтобы каждый токен мог быть использован только один раз.

JWT (JSON Web Token) — это стандартный формат токена, который используется для безопасной передачи данных между клиентом и сервером. Он часто применяется в системах аутентификации и авторизации пользователей.
Структура JWT
JWT состоит из трех частей, которые разделены точками:
Header (Заголовок):
Содержит информацию о типе токена (обычно "JWT") и алгоритме подписи, используемом для его создания (например, HMAC SHA256 или RSA).
Payload (Полезная нагрузка):
Содержит данные, которые вы хотите передать. Это могут быть утверждения о пользователе, такие как его идентификатор, роль и другие метаданные. Полезная нагрузка представлена в виде JSON-объекта.
Signature (Подпись):
Формируется на основе заголовка и полезной нагрузки с использованием секретного ключа. Подпись позволяет проверить целостность токена и удостовериться, что он не был изменён.